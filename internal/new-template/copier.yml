_min_copier_version: "9.0"
_subdirectory: .

# Questions
template_slug:
  type: str
  help: Kebab-case (or short single word) directory name for the new template. Concise slugs are encouraged (e.g. docs, plan, sst, api, mobile-api, payments-service)

_message_after_copy: |
  New template scaffold created at templates/{{ template_slug }}
  You can now add project-specific files under that directory. Shared chatmodes were copied.

_tasks:
  # Create target directories (mkdir -p behavior)
  - "mkdir -p templates/{{ template_slug }}/.github/chatmodes"
  - "mkdir -p templates/{{ template_slug }}/.github/instructions"
  - "mkdir -p templates/{{ template_slug }}/.github/prompts"
  # Copy entire common .vscode directory (if present)
  - "bash -c 'if [ -d common/.vscode ]; then mkdir -p templates/{{ template_slug }}/.vscode; rsync -a common/.vscode/ templates/{{ template_slug }}/.vscode/; fi'"
  # Seed with current shared chatmodes only (resilient if none exist)
  - 'bash -c ''set -e; shopt -s nullglob; copied=0; for f in common/.github/chatmodes/*.chatmode.md; do [ -e "$f" ] || continue; cp "$f" templates/{{ template_slug }}/.github/chatmodes/; copied=1; done; if [ $copied -eq 0 ]; then echo "(No shared chatmode files to seed)"; fi'''
  - "echo 'Scaffold complete.'"
